1) В очередь макрозадач попадает коллбек () => console.log('James'); который будет выполнится через 10 секунд
2) В очередь макрозадач попадает коллбек setTimeout
3) Минимум через 10 секунд выполняется 1-я функция оз очереди макрозадач. Выводим James.
    В очередь макрозадач опять добавляем коллбек () => console.log('James');
4) Далее из очереди макрозадач берем коллбек setTimeout. Создается синхронно промис, поэтому увидим Richard в консоли.
    Коллбек промиса добавится в очередь микрозадач.
5) Далее синхронно выведится John.
6) Далее смотрим, что в очереди микрозадач есть коллбек и выведится переданный в промис then Robert.
7) Далее setTimeout поставит в очередь макрозадач следом за коллбеком setInterval свой коллбек.
8) Далее в очереди микрозадач ничего нет, смотрим в очередь макрозадач. Там коллбек setInterval. Выведится James. 
    Ставится в очередь микрозадач коллбек setInterval.
9) Далее из очереди макрозадач берем коллбек второго setTimeout. Выводим Michael. Останавливаем интервальное выполнение функции.

Таким образом, вывод: James, Richard, John, Robert, James, Michael.